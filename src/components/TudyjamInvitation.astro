---
interface Props {}
---

<div class="container">
  <a class="alt invit" href="/tudyjam">
    <img
      class="invitation"
      src="/tudyjam/dont_tudyjam_at_3_am.png"
      alt="Tudyjam invitation card"
    />
  </a>
</div>

<!-- Randomly offset the tudyjams -->
<script>
  let e = document.querySelector("a.invit")!;

  const moveToRandomX = () => {
    e.style.left =
      Math.ceil(
        Math.random() * (window.innerWidth - e.getBoundingClientRect().width)
      ) + "px";
  };
  const moveToRandomY = () => {
    e.style.top =
      window.scrollY +
      Math.ceil(
        Math.random() * (window.innerHeight - e.getBoundingClientRect().height)
      ) +
      "px";
  };

  moveToRandomX();
  moveToRandomY();

  const moveToRandomPos = () => {
    moveToRandomX();
    moveToRandomY();
  };

  const checkWindowSize = () => {
    let rect = e.getBoundingClientRect();
    console.log(rect.x, rect.width, window.innerWidth);
    if (
      rect.right > window.innerWidth ||
      rect.left < 0 ||
      rect.top < 0 ||
      rect.bottom > window.innerHeight
      //   false
    ) {
      moveToRandomPos();
    }
  };

  const elemScroll = () => {
    let rect = e.getBoundingClientRect();
    if (rect.top < 0 || rect.bottom > window.innerHeight) {
      moveToRandomPos();
    }
  };

  //   window.addEventListener("resize", checkWindowSize);
  //   window.addEventListener("scroll", elemScroll);

  let velocity = 0;
  setInterval(() => {
    velocity += 0.025;
    if (velocity > 5) {
      velocity = 5;
    }
    e.style.top = parseFloat(e.style.top.slice(0, -2)) + velocity + "px";
    let rect = e.getBoundingClientRect();
    if (
      parseFloat(e.style.top.slice(0, -2)) >=
      document.querySelector("body")!.getBoundingClientRect().height -
        rect.height
    ) {
      velocity = 0;
      e.style.top = "0px";
      e.style.scale = Math.min(0.25, Math.max(0.8, Math.random())).toString();
      moveToRandomX();
    }
  }, 0.01);
</script>

<style>
  .container {
    overflow: hidden;
  }

  a {
    position: absolute;
    z-index: 1;

    transition: scale 0.1s;
  }

  img {
    max-width: 60vw;
  }

  a:hover {
    scale: 0.9;
  }
</style>
